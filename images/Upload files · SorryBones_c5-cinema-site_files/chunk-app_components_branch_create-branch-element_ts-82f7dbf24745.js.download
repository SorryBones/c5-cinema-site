"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_branch_create-branch-element_ts","node_modules_delegated-events_dist_index_js"],{59753(a,b,c){function d(){if(!(this instanceof d))return new d;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}c.d(b,{f:()=>B,on:()=>A});var e,f=window.document.documentElement,g=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector;d.prototype.matchesSelector=function(a,b){return g.call(a,b)},d.prototype.querySelectorAll=function(a,b){return b.querySelectorAll(a)},d.prototype.indexes=[];var h=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;d.prototype.indexes.push({name:"ID",selector:function(a){var b;if(b=a.match(h))return b[0].slice(1)},element:function(a){if(a.id)return[a.id]}});var i=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;d.prototype.indexes.push({name:"CLASS",selector:function(a){var b;if(b=a.match(i))return b[0].slice(1)},element:function(a){var b=a.className;if(b){if("string"==typeof b)return b.split(/\s/);if("object"==typeof b&&"baseVal"in b)return b.baseVal.split(/\s/)}}});var j=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;d.prototype.indexes.push({name:"TAG",selector:function(a){var b;if(b=a.match(j))return b[0].toUpperCase()},element:function(a){return[a.nodeName.toUpperCase()]}}),d.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}},e="function"==typeof window.Map?window.Map:function(){function a(){this.map={}}return a.prototype.get=function(a){return this.map[a+" "]},a.prototype.set=function(a,b){this.map[a+" "]=b},a}();var k=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function l(a,b){var c,d,e,f,g,h,i=(a=a.slice(0).concat(a.default)).length,j=b,l=[];do if(k.exec(""),(e=k.exec(j))&&(j=e[3],e[2]||!j)){for(c=0;c<i;c++)if(g=(h=a[c]).selector(e[1])){for(d=l.length,f=!1;d--;)if(l[d].index===h&&l[d].key===g){f=!0;break}f||l.push({index:h,key:g});break}}while(e)return l}function m(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)if(e=a[c],b.isPrototypeOf(e))return e}function n(a,b){return a.id-b.id}d.prototype.logDefaultIndexUsed=function(){},d.prototype.add=function(a,b){var c,d,f,g,h,i,j,k,n=this.activeIndexes,o=this.selectors,p=this.selectorObjects;if("string"==typeof a){for(d=0,p[(c={id:this.uid++,selector:a,data:b}).id]=c,j=l(this.indexes,a);d<j.length;d++)g=(k=j[d]).key,f=k.index,h=m(n,f),h||((h=Object.create(f)).map=new e,n.push(h)),f===this.indexes.default&&this.logDefaultIndexUsed(c),i=h.map.get(g),i||(i=[],h.map.set(g,i)),i.push(c);this.size++,o.push(a)}},d.prototype.remove=function(a,b){if("string"==typeof a){var c,d,e,f,g,h,i,j,k=this.activeIndexes,m=this.selectors=[],n=this.selectorObjects,o={},p=1===arguments.length;for(e=0,c=l(this.indexes,a);e<c.length;e++)for(d=c[e],f=k.length;f--;)if(h=k[f],d.index.isPrototypeOf(h)){if(i=h.map.get(d.key))for(g=i.length;g--;)(j=i[g]).selector===a&&(p||j.data===b)&&(i.splice(g,1),o[j.id]=!0);break}for(e in o)delete n[e],this.size--;for(e in n)m.push(n[e].selector)}},d.prototype.queryAll=function(a){if(!this.selectors.length)return[];var b,c,d,e,f,g,h,i,j={},k=[],l=this.querySelectorAll(this.selectors.join(", "),a);for(b=0,d=l.length;b<d;b++)for(c=0,f=l[b],e=(g=this.matches(f)).length;c<e;c++)j[(i=g[c]).id]?h=j[i.id]:(h={id:i.id,selector:i.selector,data:i.data,elements:[]},j[i.id]=h,k.push(h)),h.elements.push(f);return k.sort(n)},d.prototype.matches=function(a){if(!a)return[];var b,c,d,e,f,g,h,i,j,k,l,m=this.activeIndexes,o={},p=[];for(b=0,e=m.length;b<e;b++)if(i=(h=m[b]).element(a)){for(c=0,f=i.length;c<f;c++)if(j=h.map.get(i[c]))for(d=0,g=j.length;d<g;d++)!o[l=(k=j[d]).id]&&this.matchesSelector(a,k.selector)&&(o[l]=!0,p.push(k))}return p.sort(n)};var o={},p={},q=new WeakMap,r=new WeakMap,s=new WeakMap,t=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function u(a,b,c){var d=a[b];return a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)},a}function v(){q.set(this,!0)}function w(){q.set(this,!0),r.set(this,!0)}function x(){return s.get(this)||null}function y(a,b){t&&Object.defineProperty(a,"currentTarget",{configurable:!0,enumerable:!0,get:b||t.get})}function z(a){if(function(a){try{return a.eventPhase,!0}catch(b){return!1}}(a)){var b=(1===a.eventPhase?p:o)[a.type];if(b){var c=function(a,b,c){var d=[],e=b;do{if(1!==e.nodeType)break;var f=a.matches(e);if(f.length){var g={node:e,observers:f};c?d.unshift(g):d.push(g)}}while(e=e.parentElement)return d}(b,a.target,1===a.eventPhase);if(c.length){u(a,"stopPropagation",v),u(a,"stopImmediatePropagation",w),y(a,x);for(var d=0,e=c.length;d<e&&!q.get(a);d++){var f=c[d];s.set(a,f.node);for(var g=0,h=f.observers.length;g<h&&!r.get(a);g++)f.observers[g].data.call(f.node,a)}s.delete(a),y(a)}}}}function A(a,b,c){var e=arguments.length>3&& void 0!==arguments[3]?arguments[3]:{},f=!!e.capture,g=f?p:o,h=g[a];h||(h=new d,g[a]=h,document.addEventListener(a,z,f)),h.add(b,c)}function B(a,b,c){return a.dispatchEvent(new CustomEvent(b,{bubbles:!0,cancelable:!0,detail:c}))}},98249(a,b,c){c.d(b,{D:()=>g,a:()=>f});var d=c(2825),e=c(75662);async function f(a,b,c){let f=new Request(b,c);f.headers.append("X-Requested-With","XMLHttpRequest");let g=await self.fetch(f);if(g.status<200||g.status>=300)throw Error(`HTTP ${g.status}${g.statusText||""}`);return(0,d.t)((0,d.P)(a),g),(0,e.r)(a,await g.text())}function g(a,b,c=1e3){return async function c(d){let e=new Request(a,b);e.headers.append("X-Requested-With","XMLHttpRequest");let f=await self.fetch(e);if(f.status<200||f.status>=300)throw Error(`HTTP ${f.status}${f.statusText||""}`);if(200===f.status)return f;if(202===f.status)return await new Promise(a=>setTimeout(a,d)),c(1.5*d);throw Error(`Unexpected ${f.status} response status from poll endpoint`)}(c)}},2825(a,b,c){function d(a){let b=[...a.querySelectorAll("meta[name=html-safe-nonce]")].map(a=>a.content);if(b.length<1)throw Error("could not find html-safe-nonce on document");return b}c.d(b,{P:()=>d,t:()=>e});class ResponseError extends Error{constructor(a,b){super(`${a} for HTTP ${b.status}`),this.response=b}}function e(a,b,c=!1){let d=b.headers.get("content-type")||"";if(!c&&!d.startsWith("text/html"))throw new ResponseError(`expected response with text/html, but was ${d}`,b);if(c&&!(d.startsWith("text/html")||d.startsWith("application/json")))throw new ResponseError(`expected response with text/html or application/json, but was ${d}`,b);let e=b.headers.get("x-html-safe");if(e){if(!a.includes(e))throw new ResponseError("response X-HTML-Safe nonce did not match",b)}else throw new ResponseError("missing X-HTML-Safe nonce",b)}},75662(a,b,c){c.d(b,{r:()=>d});function d(a,b){let c=a.createElement("template");return c.innerHTML=b,a.importNode(c.content,!0)}},32858(a,b,c){c.r(b),c(82368);var d=c(69567),e=c(76006),f=c(59753),g=c(98249),h=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};(0,f.on)("click","label.js-create-branch",a=>{let b=a.currentTarget;if(!b)return;let c=document.querySelector(".js-selected-branch"),d=b.querySelector("input"),e=document.querySelector("create-branch ref-selector"),g=document.querySelector("create-branch #source-branch-input");c.textContent=d.value,g.value=d.value;let h=b.closest("details");h.open=!1,setTimeout(()=>{(0,f.f)(e,"input-entered","")})});let i=class CreateBranchElement extends HTMLElement{set error(a){this.errorContainer.innerHTML=a||""}set result(a){this.resultContainer.innerHTML=a||""}set submitting(a){this.spinner.style.display=a?"inline":"none"}set baseRepoNwo(a){this.baseRepoName&&(this.baseRepoName.textContent=a,this.selectedNwo=a,this.renderSelectItems())}get repoDefaultBranch(){return this.sourceBranch?.getAttribute("data-default-branch")||null}renderSelectItems(){this.repos.map(a=>{let b=a.closest(".js-repo-select-label"),c=a.getAttribute("data-name")===this.selectedNwo;b?.classList.toggle("selected",c),a.checked=c})}reconcileSelection(){this.renderSelectItems()}openDialog(a){a.preventDefault();let b=this.details;b.open=!0,b.hidden=!1,b.removeAttribute("aria-hidden"),this.baseRepoNwo=this.defaultRepo}selectSourceBranch(){this.sourceBranchHeader&&this.changeSourceBranchButton&&(this.changeSourceBranchButton.hidden=!0,this.sourceBranchHeader.hidden=!1)}async setRepo(a){if(!this.sourceBranchDetails||!this.sourceBranch||!this.sourceBranchSpinner||!this.sourceBranchHeader)return;let b=a.target,c=b?.getAttribute("data-url"),d=b?.getAttribute("data-name");if(!c||!d)return;this.baseRepoNwo=d;let e=this.sourceBranchHeader.hidden,f=this.sourceBranchSpinner.content.cloneNode(!0);this.sourceBranchDetails.replaceWith(f),this.submitButton.disabled=!0;let h=await (0,g.a)(document,c);this.sourceBranch.replaceWith(h),this.sourceBranchHeader.hidden=e,this.submitButton.disabled=!1}closeDialog(){let a=this.form;a.reset(),a.hidden=!1;let b=this.details;b.hidden=!0,b.setAttribute("aria-hidden","true"),this.changeSourceBranchButton&&this.sourceBranchHeader&&(this.changeSourceBranchButton.hidden=!1,this.sourceBranchHeader.hidden=!0),this.error=null,this.result=null}flashMessage(a,b="notice"){let c=new d.R(document.querySelector(".js-flash-template"),{className:`flash-${b}`,message:a}),e=document.importNode(c,!0),f=document.querySelector("#js-flash-container");for(let g of f.children)g.classList.contains("js-flash-template")||f.removeChild(g);f.appendChild(e)}async submit(a){a.preventDefault(),this.submitting=!0;let b=this.form,c=new FormData(b);c.append("repo",c.get("repo")||""),c.append("skip_error_flash","true"),c.delete("source_branch");let d=await fetch(b.action,{method:b.method,body:c,headers:{"X-Requested-With":"XMLHttpRequest"}}),e=await d.text();d.ok?(this.error=null,b.hidden=!0,this.dispatchEvent(new CustomEvent("created")),c.has("after_create")?this.result=e:(this.closeDialog(),this.flashMessage(e))):this.error=e,this.submitting=!1;let f=this.developmentForm;if(f){let h=await (0,g.a)(document,this.sidebarUrl);this.sidebarContainer.replaceWith(h)}let i=this.desktopLink?.href;i&&window.location.replace(i)}constructor(...a){super(...a),this.defaultRepo="",this.defaultSourceBranch="",this.selectedNwo="",this.sidebarUrl=""}};h([e.fA],i.prototype,"form",void 0),h([e.fA],i.prototype,"developmentForm",void 0),h([e.fA],i.prototype,"spinner",void 0),h([e.fA],i.prototype,"errorContainer",void 0),h([e.fA],i.prototype,"details",void 0),h([e.fA],i.prototype,"resultContainer",void 0),h([e.fA],i.prototype,"baseRepoName",void 0),h([e.GO],i.prototype,"repos",void 0),h([e.fA],i.prototype,"desktopLink",void 0),h([e.fA],i.prototype,"changeSourceBranchButton",void 0),h([e.fA],i.prototype,"sourceBranch",void 0),h([e.fA],i.prototype,"sourceBranchHeader",void 0),h([e.fA],i.prototype,"sourceBranchSpinner",void 0),h([e.fA],i.prototype,"sourceBranchDetails",void 0),h([e.fA],i.prototype,"submitButton",void 0),h([e.fA],i.prototype,"sidebarContainer",void 0),h([e.Lj],i.prototype,"defaultRepo",void 0),h([e.Lj],i.prototype,"defaultSourceBranch",void 0),h([e.Lj],i.prototype,"selectedNwo",void 0),h([e.Lj],i.prototype,"sidebarUrl",void 0),i=h([e.Ih],i)}}])
//# sourceMappingURL=app_components_branch_create-branch-element_ts-725ba2b1f22b.js.map